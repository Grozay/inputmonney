<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://unpkg.com/unlazy@0.11.3/dist/unlazy.with-hashing.iife.js"
      defer
      init
    ></script>
    <script type="text/javascript">
      window.tailwind.config = {
        darkMode: ["class"],
        theme: {
          extend: {
            colors: {
              border: "hsl(var(--border))",
              input: "hsl(var(--input))",
              ring: "hsl(var(--ring))",
              background: "hsl(var(--background))",
              foreground: "hsl(var(--foreground))",
              primary: {
                DEFAULT: "hsl(var(--primary))",
                foreground: "hsl(var(--primary-foreground))",
              },
              secondary: {
                DEFAULT: "hsl(var(--secondary))",
                foreground: "hsl(var(--secondary-foreground))",
              },
              destructive: {
                DEFAULT: "hsl(var(--destructive))",
                foreground: "hsl(var(--destructive-foreground))",
              },
              muted: {
                DEFAULT: "hsl(var(--muted))",
                foreground: "hsl(var(--muted-foreground))",
              },
              accent: {
                DEFAULT: "hsl(var(--accent))",
                foreground: "hsl(var(--accent-foreground))",
              },
              popover: {
                DEFAULT: "hsl(var(--popover))",
                foreground: "hsl(var(--popover-foreground))",
              },
              card: {
                DEFAULT: "hsl(var(--card))",
                foreground: "hsl(var(--card-foreground))",
              },
            },
          },
        },
      };
    </script>
    <style type="text/tailwindcss">
      @layer base {
        :root {
          --background: 0 0% 100%;
          --foreground: 240 10% 3.9%;
          --card: 0 0% 100%;
          --card-foreground: 240 10% 3.9%;
          --popover: 0 0% 100%;
          --popover-foreground: 240 10% 3.9%;
          --primary: 240 5.9% 10%;
          --primary-foreground: 0 0% 98%;
          --secondary: 240 4.8% 95.9%;
          --secondary-foreground: 240 5.9% 10%;
          --muted: 240 4.8% 95.9%;
          --muted-foreground: 240 3.8% 46.1%;
          --accent: 240 4.8% 95.9%;
          --accent-foreground: 240 5.9% 10%;
          --destructive: 0 84.2% 60.2%;
          --destructive-foreground: 0 0% 98%;
          --border: 240 5.9% 90%;
          --input: 240 5.9% 90%;
          --ring: 240 5.9% 10%;
          --radius: 0.5rem;
        }
        .dark {
          --background: 240 10% 3.9%;
          --foreground: 0 0% 98%;
          --card: 240 10% 3.9%;
          --card-foreground: 0 0% 98%;
          --popover: 240 10% 3.9%;
          --popover-foreground: 0 0% 98%;
          --primary: 0 0% 98%;
          --primary-foreground: 240 5.9% 10%;
          --secondary: 240 3.7% 15.9%;
          --secondary-foreground: 0 0% 98%;
          --muted: 240 3.7% 15.9%;
          --muted-foreground: 240 5% 64.9%;
          --accent: 240 3.7% 15.9%;
          --accent-foreground: 0 0% 98%;
          --destructive: 0 62.8% 30.6%;
          --destructive-foreground: 0 0% 98%;
          --border: 240 3.7% 15.9%;
          --input: 240 3.7% 15.9%;
          --ring: 240 4.9% 83.9%;
        }
      }
    </style>
  </head>
  <header>
  <nav class="flex items-center p-4 bg-primary text-primary-foreground">
    <div class="flex gap-4">
      <div class="flex-1 gap-4">
        <a href="./index.html"
          ><h3 class="text-2xl font-bold">Quản lí chi tiêu</h3></a
        >
      </div>
      <a href="./table.html" class="text-lg font-medium"
        >Xem chi tiết thông tin</a
      >
      <a href="./index.html" class="text-lg font-medium"
        >Nhập liệu chi tiêu</a
      >
    </div>
  </nav>
  </header>
  <body>
    <form method="get" id="test-form">
      <div class="bg-background text-foreground p-4 rounded-lg shadow-lg">
        <label for="date" class="block text-sm font-medium">Ngày:</label>
        <input
          type="date"
          id="date"
          name="Date"
          class="w-full px-3 py-2 mt-1 text-sm text-black placeholder-zinc-400 border rounded-lg focus:outline-none focus:ring focus:ring-primary"
          placeholder="Chọn ngày..."
          required
        />
        <label for="category" class="block mt-4 text-sm font-medium"
          >Danh mục:</label
        >
        <select
          id="category"
          name="Select"
          class="w-full px-3 py-2 mt-1 text-sm text-black placeholder-zinc-400 border rounded-lg focus:outline-none focus:ring focus:ring-primary"
          required
        >
          <option value="Ăn uống">Ăn uống</option>
          <option value="Di chuyển">Di chuyển</option>
          <option value="Đồ sinh hoạt">Đồ sinh hoạt</option>
          <option value="Shopee">Shopee</option>
          <option value="Chơi">Chơi</option>
          <option value="Khác">Khác</option>
          <option value="Học tập">Học tập</option>
        </select>
        <label for="name" class="block mt-4 text-sm font-medium">Tên:</label>
        <input
          type="text"
          id="name"
          name="Name"
          class="w-full px-3 py-2 mt-1 text-sm text-black placeholder-zinc-400 border rounded-lg focus:outline-none focus:ring focus:ring-primary"
          placeholder="Nhập tên..."
        />
        <label for="amount" class="block mt-4 text-sm font-medium">Tiền:</label>
        <input
          type="number"
          id="amount"
          name="spentMoney"
          class="w-full px-3 py-2 mt-1 text-sm text-black placeholder-zinc-400 border rounded-lg focus:outline-none focus:ring focus:ring-primary"
          placeholder="Nhập số tiền..."
          required
        />

        <button
          type="submit"
          class="w-full mt-4 bg-primary text-primary-foreground hover:bg-primary/80 px-4 py-2 rounded-lg focus:outline-none focus:ring focus:ring-primary"
        >
          Submit
        </button>
      </div>
    </form>



    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        var amountInput = $("#amount");
        var submit = $("button[type='submit']");

        amountInput.on("blur", function () {
          var value = amountInput.val();
          if (value && !value.endsWith("000")) {
            amountInput.val(value + "000");
          }
        });

        amountInput.on("input", function () {
          var value = amountInput.val();
          if (value.length > 3 && value.slice(-3) === "000") {
            amountInput.val(value.slice(0, -3));
          }
        });

        submit.click(function (e) {
          e.preventDefault();
          var form = $("form#test-form");
          var data = form.serialize();

          if (amountInput.val().trim() == "") {
            data += "&Tiền=" + amountInput.val() + "000"; // Gửi số tiền với '000' ở cuối
          } else {
            data += "&Tiền="; // Gửi giá trị trống nếu không có gì nhập
          }

          submit.prop("disabled", true).text("Đang xử lý...");
          $.ajax({
            type: "get",
            url: "https://script.google.com/macros/s/AKfycbx8tSQe74cWZdMMCYt078WJND4QsJopafoBwVCuDOdXpT1ySl5dp6Bs04LpSJPsZqdpFg/exec",
            dataType: "json",
            crossDomain: true,
            data: data,
            success: function (response) {
              if (response.result == "false") {
                alert(
                  "Thêm không thành công, bạn cũng có thể sử dụng để hiển thị Popup hoặc điều hướng"
                );
              } else {
                submit.prop("disabled", false).text("Submit");
                alert("Đã thêm dữ liệu");
                form[0].reset();
              }
            },
            error: function () {
              alert("Đã xảy ra lỗi khi gửi yêu cầu.");
            },
          });
        });
      });
    </script>

    <script>
      const tableList = document.querySelector('.table-data-list')
      let datalist  = []
      const api =
        "https://script.google.com/macros/s/AKfycbxatinnUYspNSZ5Lho29h3wYCsGswcv3-OJQqRRxbJ7PjoGN48LTKfHPwwHsCVsV21BoQ/exec";
      fetch(api)
        .then((response) => response.json())
        .then((data) => datalist =  data)
        .catch((error) => console.error(error));
        datalist.forEach((item) => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${item.Ngày}</td>
            <td>${item.Danhmục}</td>
            <td>${item.Tên}</td>
            <td>${item.Tiền}</td>
          `
          tableList.appendChild(row);
        })
    </script>
  </body>
</html>
